# md-table-align.nvim 仕様書

## 概要
Neovim 用 Lua プラグイン。Markdown テーブルをフォーマットし、見やすく統一された構造にします。

## 機能

カーソル配下の Markdown テーブルを以下のようにフォーマットします：

- 各列の幅を統一
- セパレータ行（`|---|` など）の指定に基づいて、データを左寄せ・中央揃え・右寄せで配置
- パイプ（`|`）と内容の間に最低 1 つのスペースを確保

## 使い方

### コマンド
```vim
:MdTableAlign
```

カーソル行がテーブル内にある場合、そのテーブル全体をフォーマットします。

**注意：** このプラグインは自動フォーマットを行いません。コマンド実行時のみフォーマットします。

### キーマップ登録（オプション）

`init.lua` で自由に設定してください：

```lua
vim.keymap.set('n', '<leader>ta', ':MdTableAlign<CR>', { noremap = true, silent = true })
```

## 対応フォーマット

標準的な Markdown テーブル（パイプで区切られたテーブル）：

```markdown
| hoge | fuga | piyo |
| :--- | :--: | ---: |
| foo  | bar  |  buz |
```

### 配置方式

セパレータ行の形式で配置方式を指定：

- **左寄せ**: `:----` 
  - 例：`| hoge |` → `| hoge  |`（データは左に配置、右にスペース）
  
- **中央揃え**: `:---:`
  - 例：`| hoge |` → `| hoge  |`（データは中央に配置）
  
- **右寄せ**: `----:`
  - 例：`| hoge |` → `|  hoge |`（データは右に配置、左にスペース）

### パディングの詳細

全てのセルと行で以下の構造が保証されます：

- パイプ（`|`）の直後に必ず 1 つのスペース
- コンテンツ部分は列幅に統一
- パイプの直前に必ず 1 つのスペース

**例：列幅が 4 文字の場合**
- 左寄せ：`| foo  |` （コンテンツ：`foo ` 4文字）
- 中央揃え：`| foo  |` （コンテンツ：スペース分配）
- 右寄せ：`|  foo |` （コンテンツ：` foo` 4文字）

**セパレータ行の例**
- 左寄せ：`| :--- |` （コンテンツ：`:---` 4文字）
- 中央揃え：`| :-: |` （コンテンツ：`:--:` 4文字）
- 右寄せ：`| ---: |` （コンテンツ：`---:` 4文字）

### セパレータ行の最小列幅

セパレータ行の形式により、列幅の最小値は **3 文字** です。

- 左寄せ：`:--` （3文字）
- 中央揃え：`:-:` （3文字）
- 右寄せ：`--:` （3文字）

列幅が 3 文字未満のコンテンツは、セパレータの制約により列幅 3 で統一されます。

## エラー

テーブルが見つからない場合は `vim.notify` でメッセージを表示します。
